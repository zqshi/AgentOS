### **「灵枢」平台 - “本体论工厂”模块详细产品需求文档**

**文档编号**：LS-PRD-FR1
**模块名称**：本体论工厂
**产品定位**：企业统一语义模型（企业“数字宪法”）的可视化设计、映射、治理与演进中心。
**核心目标**：使业务专家（非技术人员）能够主导定义、维护和裁决企业核心业务概念及其关系，确保全平台语义一致，为数据融通与智能推理奠定不可动摇的基石。

---

### **一、 模块全景与核心价值**

#### **1.1 要解决的根本问题**
企业内各系统、各部门对同一业务事物（如“客户”、“订单”、“项目状态”）的理解和定义存在差异，导致数据无法有效对话，知识无法准确关联，智能应用缺乏统一的认知基础。传统的数据字典或模型管理工具无法解决语义层面的冲突与进化需求。

#### **1.2 核心设计理念**
1.  **宪法化**：本体不是普通数据模型，是企业数字世界的根本大法，其变更需受控、严谨。
2.  **业务主导**：工具必须为业务架构师、领域专家设计，屏蔽技术复杂性，强调可视化与业务逻辑表达。
3.  **双向链接**：不仅要定义“纯洁”的概念，更要管理从混乱现实（业务系统）到理想概念的标准映射。
4.  **持续治理**：提供从冲突发现、协同仲裁到裁决执行的完整治理闭环，确保“宪法”的活力与权威。

#### **1.3 核心用户角色**
| 角色 | 职责与目标 | 核心使用场景 |
| :--- | :--- | :--- |
| **业务架构师** | 设计企业顶层业务概念体系，维护本体的完整性与一致性。 | 设计新本体，评审和合并分支，主导重大变更的仲裁。 |
| **领域专家** | 定义和维护其业务领域内的核心实体、属性与业务规则。 | 在其负责的领域内创建和修改实体，定义业务规则。 |
| **数据治理员/分析师** | 负责将实际业务数据与本体标准对齐，确保数据“守法”。 | 配置和维护源系统到本体的映射规则，测试映射结果。 |
| **冲突仲裁委员** | 裁决因业务视角不同产生的语义冲突，做出权威定义。 | 参与冲突仲裁会议，查看影响分析，投票或做出最终裁决。 |

---

### **二、 详细功能需求**

#### **FR1.1 可视化本体建模器**

**目标**：提供一个直观、强大且严谨的图形化工具，让用户能像绘制业务流程图一样，设计和管理企业的核心语义网络。

| 功能组件 | 详细需求描述 |
| :--- | :--- |
| **1. 画布工作区** | • **拖拽创建**：从工具栏拖拽“实体”、“关系”等图形元素至画布。<br>• **自由布局与自动对齐**：支持用户自由移动元素，并提供网格对齐、自动排版辅助功能。<br>• **多层级视图**：支持通过“包”或“子域”对本体进行逻辑分层，可折叠/展开。例如“供应链域”下包含“采购”、“物流”等子视图。 |
| **2. 实体定义与管理** | • **属性面板**：点击画布上任意实体，右侧属性面板可编辑：<br>  &nbsp;&nbsp;- **基础信息**：名称、唯一标识、描述、所属域/分类。<br>  &nbsp;&nbsp;- **继承关系**：可通过拖拽在实体间建立“父子”（is-a）继承关系。子类自动继承父类所有属性和关系。<br>• **属性管理**：在实体属性面板内，可添加自定义属性：<br>  &nbsp;&nbsp;- **属性定义**：属性名、数据类型（文本、数值、日期、枚举等）、是否必填、唯一性约束、默认值。<br>  &nbsp;&nbsp;- **高级约束**：支持正则表达式验证、数值范围等约束定义。 |
| **3. 关系定义与管理** | • **连线创建**：从源实体拖出连接线至目标实体以创建关系。<br>• **关系属性面板**：点击关系连线，可编辑：<br>  &nbsp;&nbsp;- **关系语义**：名称（如“供应”、“隶属于”、“负责”），支持双向关系命名（如“供应”/“被供应于”）。<br>  &nbsp;&nbsp;- **多重性**：定义关系的基数，如“1对1”、“1对多”、“多对多”。图形上用“1”、“*”、“0..1”等标注在线段端点。<br>  &nbsp;&nbsp;- **关系属性**：可为关系本身定义属性（如“供应关系.合作起始日期”）。 |
| **4. 业务规则挂载** | • **规则编辑器**：在实体或关系的属性面板中，设有“业务规则”标签页。<br>• **触发式规则**：提供表单化或简化脚本的规则编写界面。例如：<br>  &nbsp;&nbsp;`当 [实体:合同.金额] 大于 [值:1000000] 时，则 [动作: 需 [角色:法务总监] 审批]`<br>• **声明式约束**：可定义属性间的约束，如 `[项目.结束日期] 必须晚于 [项目.开始日期]`。<br>• **规则生效范围**：规则需与实体/关系一同进行版本和分支管理。 |
| **5. 版本与分支管理** | • **版本快照**：用户可手动或系统定期（如每次发布时）创建本体版本快照（V1.0, V2.0）。<br>• **版本对比**：选择任意两个版本，系统以图形化方式高亮显示被增、删、改的实体、关系和属性。<br>• **分支创建**：允许用户基于某个主干版本创建分支（如“欧洲区分支”），在分支上独立演化。<br>• **分支合并**：提供分支合并工具，自动检测分支与主干之间的冲突（修改同一概念），并将冲突列表提交给用户进行逐一抉择（选择保留分支、主干或手动修改）。 |

#### **FR1.2 语义映射中心**

**目标**：建立企业“宪法”（本体）与各地“地方法规”（业务系统数据模型）之间的权威翻译手册，确保数据能准确、自动地转换为标准知识。

| 功能组件 | 详细需求描述 |
| :--- | :--- |
| **1. 映射关系配置界面** | • **双栏视图**：左侧树状列表展示**源系统结构**（如数据库表、API JSON字段），右侧树状列表展示**目标本体结构**（实体、属性）。<br>• **拖拽映射**：支持将源字段拖拽至目标实体或属性上，建立映射关系。<br>• **转换函数配置**：点击已建立的映射关系，可配置转换逻辑：<br>  &nbsp;&nbsp;- **基础转换**：如数据类型转换、字符串截取/拼接。<br>  &nbsp;&nbsp;- **条件映射**：`IF` 源字段满足某条件 `THEN` 映射到目标属性A `ELSE` 映射到属性B。<br>  &nbsp;&nbsp;- **多字段聚合**：支持将多个源字段通过公式计算后映射到一个目标属性。 |
| **2. 映射测试与仿真台** | • **样本数据加载**：用户可从源系统直接抽取或手动粘贴几条样本数据。<br>• **一键测试**：点击“测试映射”按钮，系统根据配置的规则，将样本数据运行一遍。<br>• **结果可视化**：以清晰的表格或JSON形式展示映射结果，高亮显示未能成功映射的字段及可能原因。<br>• **影响预览**：展示此条数据最终将生成或关联到知识图谱中的哪些实体和关系，让用户直观理解映射效果。 |

#### **FR1.3 冲突检测与仲裁台**

**目标**：主动发现并系统化地解决语义冲突，将部门间的“定义战争”转化为可追溯、有理有据的治理流程。

| 功能组件 | 详细需求描述 |
| :--- | :--- |
| **1. 自动化冲突扫描引擎** | • **扫描触发器**：可配置定时任务，或在“新数据源接入”、“本体分支合并”等关键事件后自动触发扫描。<br>• **冲突类型检测**：<br>  &nbsp;&nbsp;- **同名异物**：检测不同业务域中名称相同但映射到不同本体概念的源字段（如销售系统的“客户”指联系人，财务系统的“客户”指法人实体）。<br>  &nbsp;&nbsp;- **同物异名**：检测映射到同一本体概念，但名称完全不同的源字段。<br>  &nbsp;&nbsp;- **结构失配**：检测源数据与目标本体在数据类型、约束上的不匹配。 |
| **2. 冲突报告与任务分发** | • **冲突看板**：所有检测到的冲突按状态（待处理、仲裁中、已解决）列表展示。<br>• **冲突详情**：点击任一冲突，展示：<br>  &nbsp;&nbsp;- **冲突双方**：冲突的源系统、字段、所属部门。<br>  &nbsp;&nbsp;- **影响分析**：此冲突影响哪些下游数据流程、知识卡片或智能体应用。<br>• **任务自动创建**：为每个新冲突自动创建一个“仲裁任务”，并根据预设规则@相关数据所有者及业务负责人。 |
| **3. 协作仲裁工作区** | • **会议式界面**：仲裁任务界面类似在线会议，集成讨论区、投票工具、裁决结论记录。<br>• **上下文展示**：并列展示冲突各方的定义、映射关系及业务用例。<br>• **裁决选项**：仲裁委员可提出裁决方案，如：<br>  &nbsp;&nbsp;1. **采用A方案**，并修改本体以涵盖B的部分含义。<br>  &nbsp;&nbsp;2. **创建新概念C**，A和B分别映射到C的不同子类。<br>• **投票与终裁**：支持委员投票，或由指定的首席架构师做出最终裁决。 |
| **4. 裁决执行与闭环** | • **一键同步**：裁决结论（如“统一采用‘签约客户’概念”）确认后，系统自动或经批准后，修改相关映射配置或本体定义。<br>• **变更通知**：自动通知所有受此冲突影响的上下游流程负责人。<br>• **审计追踪**：完整记录冲突从发现、讨论、裁决到执行的全过程，归档备查。 |

---

### **三、 核心业务流程示例**

**流程：处理“客户”定义冲突**
1.  **触发**：接入新的“客服系统”时，**冲突扫描引擎**发现其“客户”表映射到本体的 `联系人` 实体，而与已接入的“财务系统”中映射到 `法人实体` 的“客户”字段冲突。
2.  **报告**：在**冲突看板**生成一条“同名异物”冲突任务，自动@销售、财务、客服的数据治理员。
3.  **仲裁**：相关方进入**协作仲裁工作区**。业务架构师主持，各方陈述业务场景。经讨论，裁决为：本体中 `客户` 概念过于宽泛，将其拆分为 `签约客户（法人实体）` 和 `服务联系人` 两个子类。
4.  **执行**：架构师在**建模器**中修改本体，创建子类。数据治理员在**映射中心**分别修改两个系统的映射指向新的子类，并用**仿真台**验证。
5.  **闭环**：系统自动更新所有相关数据的历史映射，冲突状态置为“已解决”，通知关闭。整个过程被完整记录。

---
**文档状态**：`评审中`
**下一步**：本PRD确认后，将启动UI/UX原型设计，并与“知识熔炉”模块对接联调。