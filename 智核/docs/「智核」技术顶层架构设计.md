# 「智核」技术顶层架构设计

**版本**：V1.0  
**目标**：支撑智核前台体验与灵枢能力对接的可扩展架构  
**适用范围**：智核产品方向（前台智能工作台）

---

## 1. 架构总览

智核采用“前端体验层 + 前台服务层 + 集成适配层”的组合架构：

1. **前端体验层**：主工作台、知识库、情境面板、团队空间等UI。  
2. **前台服务层**：会话、搜索、协作、权限与配置。  
3. **集成适配层**：与灵枢/无影的API对接与适配。  

---

## 2. 关键组件与职责

- **工作台服务**：对话会话、任务编排、摘要与搜索聚合。  
- **知识库服务**：文档管理、版本与评审、图谱视图适配。  
- **情境面板服务**：上下文识别、嵌入式渲染、快捷操作。  
- **团队空间服务**：空间组织、知识沉淀、协作度量。  
- **智能体市场服务**：订阅、配置、使用反馈。  
- **协作与审阅服务**：评论、评审流程、发布状态。  
- **设置与权限服务**：偏好、权限、团队管理。  

---

## 3. 数据与存储

- **前台状态与配置**：用户偏好、会话索引、快捷配置。  
- **协作数据**：评论、评审记录、任务状态。  
- **缓存层**：搜索结果、推荐结果、会话摘要。  

核心知识与智能能力均来自灵枢，不在智核侧落地核心知识库。

---

## 4. 服务边界与 DDD 对齐

建议的 Bounded Context：

- workbench  
- knowledge-base  
- context-panel  
- team-space  
- agent-market  
- collaboration  
- settings

各上下文内部按 DDD 四层（domain/application/infrastructure/interfaces）拆分，避免跨上下文 domain 直接耦合。

---

## 5. 核心交互流程（技术视角）

1. **对话请求**：前端 → 工作台服务 → 灵枢API → 结果展示。  
2. **知识创作**：编辑器 → 协作/版本服务 → 灵枢入库。  
3. **情境推送**：上下文识别 → 灵枢检索 → 面板渲染。  
4. **协作评审**：评审流程 → 状态更新 → 发布与通知。  

---

## 6. 非功能与治理要求（摘要）

- 低延迟体验：关键交互 < 1 秒响应。  
- 可用性：前端与服务多实例部署。  
- 可观测：日志、指标、前端埋点。  
- 兼容性：适配主流浏览器与移动端。  

---

## 7. 组件依赖关系（顶层）

- **工作台服务** → **灵枢问答/任务 API**  
- **知识库服务** → **灵枢入库与图谱 API**  
- **情境面板服务** → **无影嵌入能力** → **灵枢检索 API**  
- **协作与审阅服务** ← **知识库服务**（内容载体）  
- **设置与权限服务** → **无影安全网关**  

---

## 8. 接口清单（顶层）

- **Workbench API**：对话、任务编排、摘要与搜索。  
- **Knowledge API**：文档管理、版本、发布与图谱视图。  
- **Context API**：上下文识别、面板渲染与快捷操作。  
- **Collaboration API**：评审、评论、发布状态。  
- **Team API**：团队空间、成员与权限。  
- **Agent Market API**：订阅、配置、反馈。  
